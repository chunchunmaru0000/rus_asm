#!/bin/bash

file="$1"
dict=(
# TODO: по человечески сделать
    "punpckhqdq урспввдв"
    "punpcklqdq урспнвдв"
    "punpckhdq урспвчв"
    "punpckhwd урспвдч"
    "punpckhbw урспвбд"
    "punpckldq урспнчв"
    "punpcklwd урспндч"
    "punpcklbw урспнбд"
    "cvttps2dq преоуо2чч"
    "packssdw уупкзнчд"
    "packuswb уупкбндб"
    "packsswb уупкзндб"
    "cvtps2dq преуо2чч"
    "cvtdq2ps пречч2уо"
    "cvtsd2ss пресд2со"
    "cvtss2sd пресо2сд"
    "cvtpd2ps преуд2уо"
    "cvtps2pd преуо2уд"
    "movmskpd бмзуд"
    "movmskps бмзуо"
    "pshufhw утасвд"
    "pshuflw утаснд"
    "pcmpeqd усраврч"
    "pcmpeqw усраврд"
    "pcmpeqb усраврб"
    "pcmpgtd усраввч"
    "pcmpgtw усраввд"
    "pcmpgtb усраввб"
    "rsqrtss окрньсо"
    "rsqrtps окрньуо"
    "pshufd утасч"
    "hsubps гминсуо"
    "hsubpd гминсуд"
    "haddps гплюсуо"
    "haddpd гплюсуд"
    "pslldq усллдв"
    "psrldq усплдв"
    "movdqu бытьчвнр"
    "movdqa бытьчвр"
    "andnpd инуд"
    "andnps инуо"
    "sqrtsd крньсд"
    "sqrtpd крньуд"
    "sqrtss крньсо"
    "sqrtps крньуо"
    "psllq усллв"
    "psrlq усплв"
    "pslld усллч"
    "psrad успач"
    "psrld усплч"
    "psllw усллд"
    "psraw успад"
    "psrlw усплд"
    "maxsd макссд"
    "maxpd максуд"
    "maxss макссо"
    "maxps максуо"
    "divsd делсд"
    "divpd делуд"
    "divss делсо"
    "divps делуо"
    "minsd минмсд"
    "minpd минмуд"
    "minss минмсо"
    "minps минумо"
    "subsd минссд"
    "subpd минсуд"
    "subss минссо"
    "subps минсуо"
    "mulsd умнсд"
    "mulpd умнуд"
    "mulss умнсо"
    "mulps умнуо"
    "addsd плюссд"
    "addpd плюсуд"
    "addss плюссо"
    "addps плюсуо"
    "xorpd исклуд"
    "xorps исклуо"
    "andpd иуд"
    "andps иуо"
    "rcpss осо"
    "rcpps оуо"
    "orpd илиуд"
    "orps илиуо"
    
    "pcmpistri усравняи"
    "pcmpistrm усравням"
    "pcmpestri усравяи"
    "pcmpestrm усравям"
    "extractps извлуо"
    "cvttsd2si преосд2зч"
    "cvttpd2pi преоуд2уч"
    "cvttss2si преосо2зч"
    "cvttps2pi преоуо2уч"
    "insertps вствуо"
    "cvtsd2si пресд2зч"
    "cvtpd2pi преуд2уч"
    "cvtss2si пресо2зч"
    "cvtps2pi преуо2уч"
    "cvtsi2sd пресч2сд"
    "cvtpi2pd преуч2уд"
    "cvtsi2ss пресч2со"
    "cvtpi2ps преуч2уо"
    "unpckhpd брспуд"
    "unpckhps брспуо"
    "unpcklpd брспнуд"
    "unpcklps брспнуо"
    "movshdup бовудв"
    "movsldup бонудв"
    "mpsadbw мусумарбд"
    "palignr урвнп"
    "pblendw усмшд"
    "blendpd смшуд"
    "blendps смшуо"
    "roundsd окрсд"
    "roundss окрсо"
    "roundpd окруд"
    "roundps окруо"
    "ucomisd нусравсд"
    "ucomiss нусравсо"
    "movntpd бнвуд"
    "movntps бнвуо"
    "movddup бдудв"
    "movlhps бнв"
    "movhlps бвн"
    "pinsrd увтсв"
    "pinsrq увтсв"
    "pextrd уизвл"
    "pextrq уизвл"
    "pinsrb увствб"
    "pextrw уизвлд"
    "pextrb уизвлб"
    "comisd супчсд"
    "comiss супчсо"
    "movapd бууд"
    "movaps бууо"
    "movhpd бвуд"
    "movhps бвуо"
    "movlpd бнуд"
    "movlps бнуо"
    "movupd бнруд"
    "movups бнруо"
    "movsd бсд"
    "movss бсо"
    "dppd спруд"
    "dpps спруо"

    "executable исп"
    "writeable изм"
    "writable изм"
    "readable чит"
    "syscall сзов"
    "segment участок"
    "eflags ефлаги"
	"movsxd быть"
    "rflags рфлаги"
    "loopnz цклн0"
    "loopne цклнр"
    "jecxz идесх0"
    "jrcxz идрсх0"
    "loopz цкл0"
    "loope цклр"
    "movsb бытьсб"
    "movsw бытьсд"
    "movsd бытьсч"
    "movsq бытьсв"
    "cmpsb сравсб"
    "cmpsw сравсд"
    "cmpsd сравсч"
    "cmpsq сравсв"
	"outsb вывсб"
	"outsw вывсд"
	"outsd вывсч"
    "qword вбайт"
    "dword чбайт"
    "pause пауза"
    "fwait ожид"
    "entry вход"
    "callf зовф"
    "pushf токлф"
    "flags флаги"
	"stosb выгсб"
	"stosw выгсд"
	"stosd выгсч"
	"stosq выгсв"
	"lodsb загсб"
	"xword эбайт"
	"yword юбайт"
	"zword ябайт"
	"lodsw загсд"
	"lodsd загсч"
	"lodsq загсв"
	"scasb осмсб"
	"scasw осмсд"
	"scasd осмсч"
	"scasq осмсв"
	"iretq воздфв"
	"enter войти"
	"leave выйти"
    "repnz повтн0"
    "repne повтнр"
    "xmm10 э10"
    "xmm11 э11"
    "xmm12 э12"
    "xmm13 э13"
    "xmm14 э14"
    "loop цкл"
    "word дбайт"
    "cwde передч"
    "cdqe перечв"
	"insb ввсб"
	"popf вытф"
	"sahf загахф"
	"lahf выгахф"
	"insw ввсд"
	"int3 прер3"
	"insd ввсч"
	"xchg обмн"
    "wait ожид"
    "byte байт"
    "lock атом"
    "jnae иднвр"
    "jnbe иднпр"
    "jnge иднбр"
    "jnle иднмр"
    "call зов"
    "idiv здел"
    "imul зумн"
    "push толк"
    "jmpf идтиф"
    "retf воздф"
    "imul зумн"
    "test проб"
    "ldtr лдтр"
    "r10b б10"
    "r11b б11"
    "r12b б12"
    "r13b дб3"
    "r14b б14"
    "r15b б15"
    "r10b р10б"
    "r11b р11б"
    "r12b р12б"
    "r13b р13б"
    "r14b р14б"
    "r15b р15б"
    "r10w д10"
    "r11w д11"
    "r12w д12"
    "r13w д13"
    "r14w д14"
    "r15w д15"
    "r10w р10д"
    "r11w р11д"
    "r12w р12д"
    "r13w р13д"
    "r14w р14д"
    "r15w р15д"
    "r10d е10"
    "r11d е11"
    "r12d е12"
    "r13d е13"
    "r14d е14"
    "r15d е15"
    "r10d р10ч"
    "r11d р11ч"
    "r12d р12ч"
    "r13d р13ч"
    "r14d р14ч"
    "r15d р15ч"
    "int1 прер1"
    "xmm0 э0"
    "xmm1 э1"
    "xmm2 э2"
    "xmm3 э3"
    "xmm4 э4"
    "xmm5 э5"
    "xmm6 э6"
    "xmm7 э7"
    "xmm8 э8"
    "xmm9 э9"
    "xmm15 э15"
    "rep повт"
    "not не"
    "neg нег"
    "hlt ост"
    "cmc нсф"
    "clc осф"
    "stc усф"
    "cli опрерф"
    "sti упрерф"
    "cld орф"
    "std урф"
    "nop ыыы"
	"cbw перебд"
	"cwd превдч"
	"cdq превчв"
	"cqo преввш"
    "jpe идчр"
    "jle идмр"
    "jmp идти"
    "int прер"
    "pop выт"
    "inc увлч"
    "dec умнш"
    "ret возд"
    "jno идни"
    "jnb иднп"
    "jae идвр"
    "jnc иднс"
    "jnz идн0"
    "jne иднр"
    "jbe идпр"
    "jna иднв"
    "jns иднз"
    "jnp иднч"
    "jpo иднч"
    "jnl иднм"
    "jge идбр"
    "jle идмр"
    "jng иднб"
    "mov быть"
    "add плюс"
    "sub минс"
    "cmp срав"
    "and и"
    "div дел"
    "mul умн"
    "xor искл"
    "adc плюсс"
    "sbb минсп"
    "rol врщл"
    "ror врщп"
    "rcl врсл"
    "rcr врсп"
    "shl сдвл"
    "sal сдал"
    "shr сдвп"
    "sar сдап"
# инструкции типа rol1 в fasmе не существуют и являются просто rol
    "r8b б8"
    "r9b б9"
    "r8b р8б"
    "r9b р9б"
    "r8w д8"
    "r9w д9"
    "r8w р8д"
    "r9w р9д"
    "eax еах"
    "ebx ебх"
    "ecx есх"
    "edx едх"
    "esi еси"
    "edi еди"
    "ebp ебп"
    "esp есп"
    "r8d е8"
    "r9d е9"
    "r8d р8ч"
    "r9d р9ч"
    "eip еип"
    "lea задр"
    "rax рах"
    "rbx рбх"
    "rcx рсх"
    "rdx рдх"
    "rsi рси"
    "rdi рди"
    "rbp рбп"
    "rsp рсп"
    "r10 р10"
    "r11 р11"
    "r12 р12"
    "r13 р13"
    "r14 р14"
    "r15 р15"
    "out вывд"
    "rip рип"
    "jo иди"
    "jb идп"
    "jc идс"
    "jz ид0"
    "je идр"
    "ja идв"
    "js идз"
    "jp идч"
    "jg идб"
	"jl идм"
    "or или"
    "cs кс"
    "ds дс"
    "es ес"
    "ss сс"
    "fs фс"
    "gs гс"
    "tr тр"
    "ah аг"
    "dh дг"
    "ch сг"
    "bh бг"
    "al ал"
    "dl дл"
    "cl сл"
    "bl бл"
    "ax ах"
    "cx сх"
    "dx дх"
    "bx бх"
    "sp сп"
    "bp бп"
    "si си"
    "di ди"
    "ip ип"
    "r8 р8"
    "r9 р9"
    "in ввд"
#    "fs испфс" "gs испгс"
)

wass=0
wasn0=0

for pair in "${dict[@]}"; do
	read -r old new <<< "$pair"
	was=$(grep -o "$old" "$file" | wc -l)
	sed -i "s/$old/$new/g" $file

	if [ "$was" -gt 0 ]; then
		echo -e "$old\t->\t$new\t$was раз"
		wass=$((wass + was))
		wasn0=$((wasn0 + 1))
	fi
done

echo -e "слов заменено: $wasn0 раз, замен всего: $wass"
