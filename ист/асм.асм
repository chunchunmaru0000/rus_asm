вот ПРяд.нч	0	; 0x00000000
вот ПРяд.запас	8	; 0x00000008
вот ПРяд.размер	12	; 0x0000000c

вот Лексема.вид	0	; 0x00000000
вот Лексема.чсл	8	; 0x00000008
вот Лексема.вещ	8	; 0x00000008
вот Лексема.стр	8	; 0x00000008

участок чит изм

йцук__ч32:
	пусть чбайт 0	; 0x00000000
__МИНУС__[ц8_2]:
	пусть байт "-" 0
__ЧИСЛО_НА_ВЫВОД__[ц8_24]:
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
	пусть байт 0	; 0x00000000
__ТОЧКА__[ц8_2]:
	пусть байт "." 0
__ВЫВОДИТЬ_ЧИСЕЛ_ПОСЛЕ_ЗАПЯТОЙ__ц32:
	пусть чбайт 6	; 0x00000006
__РАЗМЕР_ПЛАСТА__ч64:
	пусть вбайт 1048576	; 0x00100000
__ПЛАСТ__ук_ц8:
	пусть вбайт 0	; 0x00000000
__КОНЕЦ_ПЛАСТА__ук_ц8:
	пусть вбайт 0	; 0x00000000
__ПЛАСТ_ЩАС__ук_ц8:
	пусть вбайт 0	; 0x00000000
пусть _с0 байт "(ноль)" 0
пусть _с1 байт "тест.асм" 0
пусть _с2 байт "тест" 0
пусть _с3 байт "\n" 0

участок чит исп

вещать__{ч64_тлен}:

	быть рбх рси
	проб рбх рбх
	идн0 __ВЫВОД_НЕ_0

	быть рси __ЧИСЛО_НА_ВЫВОД__[ц8_24]
	быть байт(рси) "0"
	искл рсх рсх ++рсх
	идти __КОНЕЧНЫЙ_ВЫВОД_ЧИСЛА

__ВЫВОД_НЕ_0:
	иднз __ВЫВОД_БЕЗ_ЗНАКА

	искл еах еах ++еах ; еах = 1
	быть еди еах
	быть рси __МИНУС__[ц8_2]
	быть рдх еах ; длина минуса(1)
	сзов
	нег рбх

__ВЫВОД_БЕЗ_ЗНАКА:
	быть рах рбх ; число на вывод
	быть рси __ЧИСЛО_НА_ВЫВОД__[ц8_24] + 24
	искл есх есх
	быть рди 10

	__ВЫВОД_ОДНОЙ_ЦИФРЫ:
		--рси
		++есх
		искл рдх рдх
		дел рди ; / 10

		плюс дл "0"
		быть (рси) дл
	проб рах рах
	идн0 __ВЫВОД_ОДНОЙ_ЦИФРЫ

__КОНЕЧНЫЙ_ВЫВОД_ЧИСЛА:
	искл еах еах ++еах	; еах = 1
	быть еди еах
						; рси уже где надо
	быть рдх рсх
	сзов
	возд

вещать__{в64_тлен}:

	бытьэ рах э0
	быть рсх рах
	сдвп рсх 63
	проб сл сл ; сравнение старшего бита в double
	ид0 __НЕ_УБИРАТЬ_ЗНАК_ПРИ_ВЫВОДЕ_ВЕЩ
		сдвл рах 1 ; затирание
		сдвп рах 1 ; бита
		бытьэ э0 рах
		быть рси __МИНУС__[ц8_2]
		зов вещать__{ук_ц8_тлен}	; вывод минуса
	__НЕ_УБИРАТЬ_ЗНАК_ПРИ_ВЫВОДЕ_ВЕЩ:

	бытьэ э1 э0
	преосд2зч рси э0	; в рси целая часть
	пресч2сд э0 рси	; в э0  целая часть
	минссд э1 э0	; в э1  часть после запятой

	зов вещать__{ч64_тлен}		; вывод целой части
	быть рси __ТОЧКА__[ц8_2]
	зов вещать__{ук_ц8_тлен}	; вывод точки

	; чисел после запятой
	быть есх чбайт(__ВЫВОДИТЬ_ЧИСЕЛ_ПОСЛЕ_ЗАПЯТОЙ__ц32)
	проб есх есх
	ид0 __ВЕЩАТЬ_ВЕЩ_БЕЗ_ВЫВОДА_ПОСЛЕ_ЗАПЯТОЙ
	; э0 = 10.0
	быть рах вбайт 10.0
	бытьэ э0 рах
	быть рси __ЧИСЛО_НА_ВЫВОД__[ц8_24]

	__ВЕЩАТЬ_ВЕЩ_ЦИКЛ_ВЫВОД_ПОСЛЕ_ЗАПЯТОЙ:
		умнсд э1 э0
		преосд2зч ебх э1

		быть дл бл
		плюс дл "0"
		быть байт(рси) дл
		++рси

		пресч2сд э2 ебх
		минссд э1 э2
	--есх
	идн0 __ВЕЩАТЬ_ВЕЩ_ЦИКЛ_ВЫВОД_ПОСЛЕ_ЗАПЯТОЙ

	искл еах еах ++еах	; write(1)
	быть еди еах 		; stdout(1)
	быть рси __ЧИСЛО_НА_ВЫВОД__[ц8_24]
	быть едх чбайт(__ВЫВОДИТЬ_ЧИСЕЛ_ПОСЛЕ_ЗАПЯТОЙ__ц32)
	сзов

__ВЕЩАТЬ_ВЕЩ_БЕЗ_ВЫВОДА_ПОСЛЕ_ЗАПЯТОЙ:
	возд

вещать__{в64_ц32_тлен}:

	быть еах чбайт(__ВЫВОДИТЬ_ЧИСЕЛ_ПОСЛЕ_ЗАПЯТОЙ__ц32)
	толк рах ; сохранить прошлое значение
	быть чбайт(__ВЫВОДИТЬ_ЧИСЕЛ_ПОСЛЕ_ЗАПЯТОЙ__ц32) еси ; установить новое значение

	; вещ уже в э0
	зов вещать__{в64_тлен}

	выт рах
	быть чбайт(__ВЫВОДИТЬ_ЧИСЕЛ_ПОСЛЕ_ЗАПЯТОЙ__ц32) еах ; восстановить прошлое значение
	возд

вещать_ноль__{тлен}:
	толк рбп
	быть рбп рсп
	минс рсп 0	; 0x00000000
	; вещать("(ноль)")
	; "(ноль)"
	быть рах _с0
	быть рси рах
	зов вещать__{ук_ц8_тлен}
	выйти
	возд

вещать__{ук_ц8_тлен}:

	проб рси рси
	ид0 вещать_ноль__{тлен}

	быть рди рси
	искл еах еах
	искл рсх рсх
	не рсх
	орф
	повтн0 осмсб
	быть рдх рди

	++еах 				; еах = write(1)
	быть еди еах	 	; еди = stdout(1)
						; рси строка
	минс рдх рси --едх	; длина строки
	сзов
	возд

вторить__{ук_тлен_ук_тлен_ц32_тлен}:

	; из - рси
	; в  - рди
	; длиной - е8

	орф
	искл рсх рсх ; знак не предпологается

	быть есх е8
	сдвп есх 3 ; делить на 8
	ид0 __вторить{}__ПРОПУСТИТЬ_ВБАЙТ
	повт бытьсв

__вторить{}__ПРОПУСТИТЬ_ВБАЙТ:
	быть есх е8
	и есх 7    ; остаток от 8
	ид0 __вторить{}__ПРОПУСТИТЬ_БАЙТ

	сдвп сл 2  ; делить на 4
	ид0 __вторить{}__ПРОПУСТИТЬ_ЧБАЙТ
	повт бытьсч

__вторить{}__ПРОПУСТИТЬ_ЧБАЙТ:
	быть есх е8
	и есх 3    ; остаток от 4
	ид0 __вторить{}__ПРОПУСТИТЬ_БАЙТ
	повт бытьсб

__вторить{}__ПРОПУСТИТЬ_БАЙТ:
	возд

начать_пласт__{ч64_тлен}:

	плюс вбайт(__РАЗМЕР_ПЛАСТА__ч64) рси
	идти начать_пласт__{тлен}
	возд

начать_пласт__{тлен}:

	быть рах 9 		; mmap
	искл рди рди	; NULL
	быть рси вбайт(__РАЗМЕР_ПЛАСТА__ч64)
	быть рдх 3 		; READ | WRITE
	быть р10 34 	; PRIVATE | ANON
	искл р8 р8 --р8 ; -1
	искл р9 р9		; 0
	сзов

	; mmap всегда возвращает адрес кратный 4096, а значит и кратный 16
	быть вбайт(__ПЛАСТ__ук_ц8) рах
	быть вбайт(__ПЛАСТ_ЩАС__ук_ц8) рах
	плюс рах вбайт(__РАЗМЕР_ПЛАСТА__ч64)
	быть вбайт(__КОНЕЦ_ПЛАСТА__ук_ц8) рах
	возд

пластом__{ч32_ук_тлен}:

	толк р15

	плюс еси 15
	и еси -16 		; выравнивание по 16 байт
	быть р15 еси

	быть рах вбайт(__ПЛАСТ_ЩАС__ук_ц8)
	плюс р15 рах
	срав р15 вбайт(__КОНЕЦ_ПЛАСТА__ук_ц8)
	; нехватка это редкий случай, поэтому прыжок на нехватку
	идб __НЕ_ХВАТАЕТ_МЕСТА_В_ПЛАСТЕ

	быть вбайт(__ПЛАСТ_ЩАС__ук_ц8) р15

	выт р15
	возд

__НЕ_ХВАТАЕТ_МЕСТА_В_ПЛАСТЕ:
	быть р15 еси 	; размер%16 в р15

	; __РАЗМЕР_ПЛАСТА = макс(__РАЗМЕР_ПЛАСТА, размер)
	быть рах вбайт(__РАЗМЕР_ПЛАСТА__ч64)
	сбытьб рах р15
	быть вбайт(__РАЗМЕР_ПЛАСТА__ч64) рах

	зов начать_пласт__{тлен}
	быть рах вбайт(__ПЛАСТ_ЩАС__ук_ц8)
	плюс р15 рах
	быть вбайт(__ПЛАСТ_ЩАС__ук_ц8) р15

	выт р15
	возд

пере_пласт__{ук_тлен_ч32_ч32_ук_тлен}:

	; рси - по_адресу
	; еди - размером
	; е8  - в_размер
	срав еди е8
	идбр __пере_пласт_ТАКЖЕ

	толк р15
	толк р14
	быть е15 еди ; размером
	быть р14 рси ; по_адресу

	быть еси е8  ; в_размер
	зов пластом__{ч32_ук_тлен}

	быть рси р14 ; по_адресу
	быть рди рах ; вернулось из пластом
	быть е8 е15  ; размером
	быть р15 рах ; сохранить новый адрес
	зов вторить__{ук_тлен_ук_тлен_ц32_тлен}

	быть рах р15
	выт р14
	выт р15
	возд

__пере_пласт_ТАКЖЕ:
	быть рах рси
	возд

новый_пряд__{ц32_ц32_ук_лик_ПРяд}:
	толк рбп
	быть рбп рсп
	минс рсп 16	; 0x00000010
	вот начальный_запас -4	; 0xfffffffc
	быть (рбп начальный_запас) еси
	вот размер_звена -8	; 0xfffffff8
	быть (рбп размер_звена) еди
	вот р -16	; 0xfffffff0
	; ((р есть ук_лик_ПРяд) = пластом((16 + (начальный_запас * размер_звена))))
	; (16 + (начальный_запас * размер_звена))
	быть еах чбайт (рбп размер_звена)
	зумн еах чбайт (рбп начальный_запас)
	плюс еах 16	; 0x00000010
	быть рси рах
	зов пластом__{ч32_ук_тлен}
	быть вбайт (рбп р) рах
	; (р->запас = начальный_запас)
	быть еах чбайт (рбп начальный_запас)
	быть рсх вбайт (рбп р)
	быть чбайт (рсх ПРяд.запас) еах
	; (р->размер = 0)
	быть рах вбайт (рбп р)
	быть чбайт (рах ПРяд.размер) 0	; 0x00000000
	; (р->нч = (р + 1))
	быть рах вбайт (рбп р)
	плюс рах 16	; 0x00000010
	быть рсх вбайт (рбп р)
	быть вбайт (рсх ПРяд.нч) рах
	; р
	быть рах вбайт (рбп р)
	выйти
	возд

добавить8__{ук_лик_ПРяд_ц8_тлен}:
	толк рбп
	быть рбп рсп
	минс рсп 10	; 0x0000000a
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот смысл -10	; 0xfffffff6
	быть (рбп смысл) ди
	; ?? (р->размер >= р->запас)
	быть рах вбайт (рбп р)
	быть еах чбайт (рах ПРяд.размер)
	быть рсх вбайт (рбп р)
	быть есх чбайт (рсх ПРяд.запас)
	срав еах есх
	идм _и0
		; (р->нч = пере_пласт(р->нч, р->размер, (р->запас *= (р->запас *= 2))))
		; р->нч
		быть рах вбайт (рбп р)
		быть рах вбайт (рах ПРяд.нч)
		быть рси рах
		; р->размер
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.размер)
		быть рди рах
		; (р->запас *= (р->запас *= 2))
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.запас)
		сдал1 еах
		быть рсх вбайт (рбп р)
		быть чбайт (рсх ПРяд.запас) еах
		быть р8 рах
		зов пере_пласт__{ук_тлен_ч32_ч32_ук_тлен}
		быть рсх вбайт (рбп р)
		быть вбайт (рсх ПРяд.нч) рах
	_и0:
	; ((окак ук_ц8 р->нч)[р->размер++] = смысл)
	быть ал байт (рбп смысл)
	быть рбх вбайт (рбп р)
	быть есх чбайт (рбх ПРяд.размер)
	быть едх есх
	плюс едх 1	; 0x00000001
	быть чбайт (рбх ПРяд.размер) едх
	быть рсх есх
	быть рдх вбайт (рбп р)
	быть рдх вбайт (рдх ПРяд.нч)
	плюс рдх рсх
	быть байт (рдх 0) ал
	выйти
	возд

добавить32__{ук_лик_ПРяд_ч32_тлен}:
	толк рбп
	быть рбп рсп
	минс рсп 12	; 0x0000000c
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот смысл -12	; 0xfffffff4
	быть (рбп смысл) еди
	; ?? (р->размер >= р->запас)
	быть рах вбайт (рбп р)
	быть еах чбайт (рах ПРяд.размер)
	быть рсх вбайт (рбп р)
	быть есх чбайт (рсх ПРяд.запас)
	срав еах есх
	идм _и1
		; (р->нч = пере_пласт(р->нч, (р->размер * 4), ((р->запас *= (р->запас *= 2)) * 4)))
		; р->нч
		быть рах вбайт (рбп р)
		быть рах вбайт (рах ПРяд.нч)
		быть рси рах
		; (р->размер * 4)
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.размер)
		сдал еах 2	; 0x00000002
		быть рди рах
		; ((р->запас *= (р->запас *= 2)) * 4)
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.запас)
		сдал1 еах
		быть рсх вбайт (рбп р)
		быть чбайт (рсх ПРяд.запас) еах
		сдал еах 2	; 0x00000002
		быть р8 рах
		зов пере_пласт__{ук_тлен_ч32_ч32_ук_тлен}
		быть рсх вбайт (рбп р)
		быть вбайт (рсх ПРяд.нч) рах
	_и1:
	; ((окак ук_ч32 р->нч)[р->размер++] = смысл)
	быть еах чбайт (рбп смысл)
	быть рбх вбайт (рбп р)
	быть есх чбайт (рбх ПРяд.размер)
	быть едх есх
	плюс едх 1	; 0x00000001
	быть чбайт (рбх ПРяд.размер) едх
	быть рсх есх
	сдал рсх 2	; 0x00000002
	быть рдх вбайт (рбп р)
	быть рдх вбайт (рдх ПРяд.нч)
	плюс рдх рсх
	быть чбайт (рдх 0) еах
	выйти
	возд

добавить64__{ук_лик_ПРяд_ч64_тлен}:
	толк рбп
	быть рбп рсп
	минс рсп 16	; 0x00000010
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот смысл -16	; 0xfffffff0
	быть (рбп смысл) рди
	; ?? (р->размер >= р->запас)
	быть рах вбайт (рбп р)
	быть еах чбайт (рах ПРяд.размер)
	быть рсх вбайт (рбп р)
	быть есх чбайт (рсх ПРяд.запас)
	срав еах есх
	идм _и2
		; (р->нч = пере_пласт(р->нч, (р->размер * 8), ((р->запас *= (р->запас *= 2)) * 8)))
		; р->нч
		быть рах вбайт (рбп р)
		быть рах вбайт (рах ПРяд.нч)
		быть рси рах
		; (р->размер * 8)
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.размер)
		сдал еах 3	; 0x00000003
		быть рди рах
		; ((р->запас *= (р->запас *= 2)) * 8)
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.запас)
		сдал1 еах
		быть рсх вбайт (рбп р)
		быть чбайт (рсх ПРяд.запас) еах
		сдал еах 3	; 0x00000003
		быть р8 рах
		зов пере_пласт__{ук_тлен_ч32_ч32_ук_тлен}
		быть рсх вбайт (рбп р)
		быть вбайт (рсх ПРяд.нч) рах
	_и2:
	; ((окак ук_ч64 р->нч)[р->размер++] = смысл)
	быть рах вбайт (рбп смысл)
	быть рбх вбайт (рбп р)
	быть есх чбайт (рбх ПРяд.размер)
	быть едх есх
	плюс едх 1	; 0x00000001
	быть чбайт (рбх ПРяд.размер) едх
	быть рсх есх
	сдал рсх 3	; 0x00000003
	быть рдх вбайт (рбп р)
	быть рдх вбайт (рдх ПРяд.нч)
	плюс рдх рсх
	быть вбайт (рдх 0) рах
	выйти
	возд

звено8__{ук_лик_ПРяд_ц32_ц8}:
	толк рбп
	быть рбп рсп
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот место -12	; 0xfffffff4
	быть (рбп место) еди
	; (окак ук_ц8 р->нч)[место]
	быть еах чбайт (рбп место)
	перечв
	быть рсх вбайт (рбп р)
	быть рсх вбайт (рсх ПРяд.нч)
	плюс рсх рах
	быть сл байт (рсх 0)
	быть рах рсх
	выт рбп
	возд

звено32__{ук_лик_ПРяд_ц32_ч32}:
	толк рбп
	быть рбп рсп
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот место -12	; 0xfffffff4
	быть (рбп место) еди
	; (окак ук_ч32 р->нч)[место]
	быть есх чбайт (рбп место)
	быть рсх есх
	сдал рсх 2	; 0x00000002
	быть рдх вбайт (рбп р)
	быть рдх вбайт (рдх ПРяд.нч)
	плюс рдх рсх
	быть едх чбайт (рдх 0)
	обмн рдх рах
	выт рбп
	возд

звено64__{ук_лик_ПРяд_ц32_ч64}:
	толк рбп
	быть рбп рсп
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот место -12	; 0xfffffff4
	быть (рбп место) еди
	; (окак ук_ч64 р->нч)[место]
	быть еах чбайт (рбп место)
	перечв
	сдал рах 3	; 0x00000003
	быть рсх вбайт (рбп р)
	быть рсх вбайт (рсх ПРяд.нч)
	плюс рсх рах
	быть рсх вбайт (рсх 0)
	быть рах рсх
	выт рбп
	возд

менять8__{ук_лик_ПРяд_ц32_ц8_тлен}:
	толк рбп
	быть рбп рсп
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот место -12	; 0xfffffff4
	быть (рбп место) еди
	вот смысл -14	; 0xfffffff2
	быть (рбп смысл) б8
	; ((окак ук_ц8 р->нч)[место] = смысл)
	быть ал байт (рбп смысл)
	быть есх чбайт (рбп место)
	быть рсх есх
	быть рбх вбайт (рбп р)
	быть рбх вбайт (рбх ПРяд.нч)
	плюс рбх рсх
	быть байт (рбх 0) ал
	выт рбп
	возд

менять32__{ук_лик_ПРяд_ц32_ч32_тлен}:
	толк рбп
	быть рбп рсп
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот место -12	; 0xfffffff4
	быть (рбп место) еди
	вот смысл -16	; 0xfffffff0
	быть (рбп смысл) е8
	; ((окак ук_ч32 р->нч)[место] = смысл)
	быть еах чбайт (рбп смысл)
	быть есх чбайт (рбп место)
	быть рсх есх
	сдал рсх 2	; 0x00000002
	быть рбх вбайт (рбп р)
	быть рбх вбайт (рбх ПРяд.нч)
	плюс рбх рсх
	быть чбайт (рбх 0) еах
	выт рбп
	возд

менять64__{ук_лик_ПРяд_ц32_ч64_тлен}:
	толк рбп
	быть рбп рсп
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот место -12	; 0xfffffff4
	быть (рбп место) еди
	вот смысл -20	; 0xffffffec
	быть (рбп смысл) р8
	; ((окак ук_ч64 р->нч)[место] = смысл)
	быть рах вбайт (рбп смысл)
	быть есх чбайт (рбп место)
	быть рсх есх
	сдал рсх 3	; 0x00000003
	быть рбх вбайт (рбп р)
	быть рбх вбайт (рбх ПРяд.нч)
	плюс рбх рсх
	быть вбайт (рбх 0) рах
	выт рбп
	возд

прдр8__{ук_лик_ПРяд_ук_тлен_ц32_тлен}:
	толк рбп
	быть рбп рсп
	минс рсп 20	; 0x00000014
	толк р15
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот из -16	; 0xfffffff0
	быть (рбп из) рди
	вот раз -20	; 0xffffffec
	быть (рбп раз) е8
	; ?? (раз == 0)
	срав чбайт (рбп раз) 0	; 0x00000000
	иднр _и3
		идти _и4
	_и3:
	; ?? (р->запас < (р->размер + раз))
	быть рах вбайт (рбп р)
	быть еах чбайт (рах ПРяд.размер)
	плюс еах чбайт (рбп раз)
	быть рсх вбайт (рбп р)
	быть есх чбайт (рсх ПРяд.запас)
	срав есх еах
	идбр _и5
		; (р->нч = пере_пласт(р->нч, р->запас, (р->запас = ((р->запас * 2) + раз))))
		быть р15 рдх
		; р->нч
		быть рах вбайт (рбп р)
		быть рах вбайт (рах ПРяд.нч)
		быть рси рах
		; р->запас
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.запас)
		быть рди рах
		; (р->запас = ((р->запас * 2) + раз))
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.запас)
		сдал1 еах
		плюс еах чбайт (рбп раз)
		быть рсх вбайт (рбп р)
		быть чбайт (рсх ПРяд.запас) еах
		быть р8 рах
		зов пере_пласт__{ук_тлен_ч32_ч32_ук_тлен}
		быть рсх вбайт (рбп р)
		быть вбайт (рсх ПРяд.нч) рах
	_и5:
	; вторить(из, ((окак ук_ц8 р->нч) + р->размер), раз)
	; из
	быть рах вбайт (рбп из)
	быть рси рах
	; ((окак ук_ц8 р->нч) + р->размер)
	быть рах вбайт (рбп р)
	быть рах вбайт (рах ПРяд.нч)
	быть рсх вбайт (рбп р)
	быть есх чбайт (рсх ПРяд.размер)
	быть рсх есх
	плюс рах рсх
	быть рди рах
	; раз
	быть еах чбайт (рбп раз)
	быть р8 рах
	зов вторить__{ук_тлен_ук_тлен_ц32_тлен}
	; (р->размер += (р->размер += раз))
	быть рах вбайт (рбп р)
	быть еах чбайт (рах ПРяд.размер)
	плюс еах чбайт (рбп раз)
	быть рсх вбайт (рбп р)
	быть чбайт (рсх ПРяд.размер) еах
	_и4:
	выт р15
	выйти
	возд

прдр32__{ук_лик_ПРяд_ук_тлен_ц32_тлен}:
	толк рбп
	быть рбп рсп
	минс рсп 20	; 0x00000014
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот из -16	; 0xfffffff0
	быть (рбп из) рди
	вот раз -20	; 0xffffffec
	быть (рбп раз) е8
	; ?? (раз == 0)
	срав чбайт (рбп раз) 0	; 0x00000000
	иднр _и6
		идти _и7
	_и6:
	; ?? (р->запас < (р->размер + раз))
	быть рах вбайт (рбп р)
	быть еах чбайт (рах ПРяд.размер)
	плюс еах чбайт (рбп раз)
	быть рсх вбайт (рбп р)
	быть есх чбайт (рсх ПРяд.запас)
	срав есх еах
	идбр _и8
		; (р->нч = пере_пласт(р->нч, (4 * р->запас), (4 * (р->запас = ((р->запас * 2) + раз)))))
		; р->нч
		быть рах вбайт (рбп р)
		быть рах вбайт (рах ПРяд.нч)
		быть рси рах
		; (4 * р->запас)
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.запас)
		сдал еах 2	; 0x00000002
		быть рди рах
		; (4 * (р->запас = ((р->запас * 2) + раз)))
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.запас)
		сдал1 еах
		плюс еах чбайт (рбп раз)
		быть рсх вбайт (рбп р)
		быть чбайт (рсх ПРяд.запас) еах
		сдал еах 2	; 0x00000002
		быть р8 рах
		зов пере_пласт__{ук_тлен_ч32_ч32_ук_тлен}
		быть рсх вбайт (рбп р)
		быть вбайт (рсх ПРяд.нч) рах
	_и8:
	; вторить(из, ((окак ук_ч32 р->нч) + р->размер), (раз * 4))
	; из
	быть рах вбайт (рбп из)
	быть рси рах
	; ((окак ук_ч32 р->нч) + р->размер)
	быть рах вбайт (рбп р)
	быть еах чбайт (рах ПРяд.размер)
	сдал еах 2	; 0x00000002
	быть рсх вбайт (рбп р)
	быть рсх вбайт (рсх ПРяд.нч)
	перечв
	плюс рсх рах
	быть рди рсх
	; (раз * 4)
	быть еах чбайт (рбп раз)
	сдал еах 2	; 0x00000002
	быть р8 рах
	зов вторить__{ук_тлен_ук_тлен_ц32_тлен}
	; (р->размер += (р->размер += раз))
	быть рах вбайт (рбп р)
	быть еах чбайт (рах ПРяд.размер)
	плюс еах чбайт (рбп раз)
	быть рсх вбайт (рбп р)
	быть чбайт (рсх ПРяд.размер) еах
	_и7:
	выйти
	возд

прдр64__{ук_лик_ПРяд_ук_тлен_ц32_тлен}:
	толк рбп
	быть рбп рсп
	минс рсп 20	; 0x00000014
	вот р -8	; 0xfffffff8
	быть (рбп р) рси
	вот из -16	; 0xfffffff0
	быть (рбп из) рди
	вот раз -20	; 0xffffffec
	быть (рбп раз) е8
	; ?? (раз == 0)
	срав чбайт (рбп раз) 0	; 0x00000000
	иднр _и9
		идти _и10
	_и9:
	; ?? (р->запас < (р->размер + раз))
	быть рах вбайт (рбп р)
	быть еах чбайт (рах ПРяд.размер)
	плюс еах чбайт (рбп раз)
	быть рсх вбайт (рбп р)
	быть есх чбайт (рсх ПРяд.запас)
	срав есх еах
	идбр _и11
		; (р->нч = пере_пласт(р->нч, (8 * р->запас), (8 * (р->запас = ((р->запас * 2) + раз)))))
		; р->нч
		быть рах вбайт (рбп р)
		быть рах вбайт (рах ПРяд.нч)
		быть рси рах
		; (8 * р->запас)
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.запас)
		сдал еах 3	; 0x00000003
		быть рди рах
		; (8 * (р->запас = ((р->запас * 2) + раз)))
		быть рах вбайт (рбп р)
		быть еах чбайт (рах ПРяд.запас)
		сдал1 еах
		плюс еах чбайт (рбп раз)
		быть рсх вбайт (рбп р)
		быть чбайт (рсх ПРяд.запас) еах
		сдал еах 3	; 0x00000003
		быть р8 рах
		зов пере_пласт__{ук_тлен_ч32_ч32_ук_тлен}
		быть рсх вбайт (рбп р)
		быть вбайт (рсх ПРяд.нч) рах
	_и11:
	; вторить(из, ((окак ук_ч64 р->нч) + р->размер), (раз * 8))
	; из
	быть рах вбайт (рбп из)
	быть рси рах
	; ((окак ук_ч64 р->нч) + р->размер)
	быть рах вбайт (рбп р)
	быть еах чбайт (рах ПРяд.размер)
	сдал еах 3	; 0x00000003
	быть рсх вбайт (рбп р)
	быть рсх вбайт (рсх ПРяд.нч)
	перечв
	плюс рсх рах
	быть рди рсх
	; (раз * 8)
	быть еах чбайт (рбп раз)
	сдал еах 3	; 0x00000003
	быть р8 рах
	зов вторить__{ук_тлен_ук_тлен_ц32_тлен}
	; (р->размер += (р->размер += раз))
	быть рах вбайт (рбп р)
	быть еах чбайт (рах ПРяд.размер)
	плюс еах чбайт (рбп раз)
	быть рсх вбайт (рбп р)
	быть чбайт (рсх ПРяд.размер) еах
	_и10:
	выйти
	возд

разобрать_на_лексемы__{ук_ц8_ук_ц8_ук_лик_ПРяд}:
	толк рбп
	быть рбп рсп
	минс рсп 24	; 0x00000018
	вот из -8	; 0xfffffff8
	быть (рбп из) рси
	вот находясь_в -16	; 0xfffffff0
	быть (рбп находясь_в) рди
	вот р -24	; 0xffffffe8
	; ((р есть ук_лик_ПРяд) = новый_пряд(1024, 8))
	; 1024
	быть еах 1024	; 0x00000400
	быть рси рах
	; 8
	быть еах 8	; 0x00000008
	быть рди рах
	зов новый_пряд__{ц32_ц32_ук_лик_ПРяд}
	быть вбайт (рбп р) рах
	; р
	быть рах вбайт (рбп р)
	выйти
	возд

вход глав__{тлен}
глав__{тлен}:
	толк рбп
	быть рбп рсп
	минс рсп 36	; 0x00000024
	вот из -8	; 0xfffffff8
	вот в -16	; 0xfffffff0
	вот лексемы -24	; 0xffffffe8
	вот ь -28	; 0xffffffe4
		вот лексема -36	; 0xffffffdc
	; начать_пласт(0x4_00_00_00)
	; 0x4_00_00_00
	быть рах 67108864	; 0x04000000
	быть рси рах
	зов начать_пласт__{ч64_тлен}
	; ((из есть ук_ц8) = "тест.асм")
	быть рах _с1
	быть вбайт (рбп из) рах
	; ((в есть ук_ц8) = "тест")
	быть рах _с2
	быть вбайт (рбп в) рах
	; ((лексемы есть ук_лик_ПРяд) = разобрать_на_лексемы(из, 0))
	; из
	быть рах вбайт (рбп из)
	быть рси рах
	; 0
	искл рах рах
	быть рди рах
	зов разобрать_на_лексемы__{ук_ц8_ук_ц8_ук_лик_ПРяд}
	быть вбайт (рбп лексемы) рах
	; (ь есть ч32) => (0 ... лексемы->размер) ( ... )
	; ((ь есть ч32) => 0)
	быть чбайт (рбп ь) 0	; 0x00000000
	идти _и13
	_и12:
		; ((лексема есть ук_лик_Лексема) = звено64(лексемы, ь))
		; лексемы
		быть рах вбайт (рбп лексемы)
		быть рси рах
		; ь
		быть еах чбайт (рбп ь)
		быть рди рах
		зов звено64__{ук_лик_ПРяд_ц32_ч64}
		быть вбайт (рбп лексема) рах
		; (вещать(лексема->вид), вещать("\n"))
			; вещать(лексема->вид)
			; лексема->вид
			быть рах вбайт (рбп лексема)
			быть рах вбайт (рах Лексема.вид)
			быть рси рах
			зов вещать__{ук_ц8_тлен}
		; "\n"
		быть рах _с3
		быть рси рах
		зов вещать__{ук_ц8_тлен}
	плюс чбайт (рбп ь) 1	; 0x00000001
	_и13:
	быть рах вбайт (рбп лексемы)
	быть еах чбайт (рах ПРяд.размер)
	срав чбайт (рбп ь) еах
	идм _и12

	быть еах 60
	быть еди 77
	сзов
	выйти
	возд

