#влечь (
	"../../../sral/б/макро/выход.ср"

	"../../../sral/б/ввыв/консоль/вещать.ср"
	"../../../sral/б/ввыв/файлы/база.ср"
	"../../../sral/б/память/вторить.ср"
	"../../../sral/б/память/пласт.ср"
	"../../../sral/б/перечни/ряд/пласт.ср"

	"../лксм/лксм.ср"
)

фц __ВХОД глав() тлен (
	начать_пласт(0x4_00_00_00),

	из есть стр = "тест.асм",
	в  есть стр = "тест",

;;
	ФЛАГИ = выявить_флаги(аргов, арги),

	обр есть лик Обик =
		(ФЛАГИ->из, 0)
		|> разобрать_на_лексемы
		|> разобрать_на_инструкции
		|> обработать_инструкции,

	байт есть ч64 = обр->ель->размер + обр->текст->размер,
	файл есть ч32 = открытьф(ФЛАГИ->в, ФлагиФйлв.Запись, 0),

	файл.писатьф(обр->ель->нч,   обр->ель->размер),
	файл.писатьф(обр->текст->нч, обр->текст->размер),

	файл.закрытьф(),

	вещать..("В файл [", ФЛАГИ->в, "] записано ", байт, " байт"),
	(конец есть ч32 = байт % 10) >= 2 || конец <= 4 ?? ( "а" |> вещать )
	вещать("\n"),
;;

	лексемы есть лик ПРяд =
		;(из, 0)
		;|> разобрать_на_лексемы,
		разобрать_на_лексемы(из, 0),

	ь есть ч32 => (0 ... лексемы->размер) (
		лексема есть лик Лексемы = лексемы.звено64(ь),
		вещать..(лексема->вид, "\n"),
	)

	выйти с кодом 77 .
)
